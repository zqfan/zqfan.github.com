<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>OpenStack Ceilometer Havana API V2</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link rel="stylesheet" href="huawei.css" type="text/css" />
</head>
<body>
<div id="header">
<h1 class="title">OpenStack Ceilometer Havana API V2</h1>
</div>
<p>Copyright (c) 2014, Huawei Technologies Co., Ltd</p>
<p>  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);<br />  you may not use this file except in compliance with the License.<br />  You may obtain a copy of the License at</p>
<p>  http://www.apache.org/licenses/LICENSE-2.0</p>
<p>  Unless required by applicable law or agreed to in writing, software<br />  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,<br />  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or<br />  implied.<br />  See the License for the specific language governing permissions and<br />  limitations under the License.</p>
<p>Author: ZhiQiang Fan <script type="text/javascript">
<!--
h='&#x67;&#x6d;&#x61;&#x69;&#108;&#46;&#x63;&#x6f;&#x6d;';a='&#64;';n='&#x61;&#106;&#x69;&#46;&#122;&#x71;&#102;&#x61;&#110;';e=n+a+h;
document.write('<a h'+'ref'+'="ma'+'ilto'+':'+e+'">'+e+'<\/'+'a'+'>');
// -->
</script><noscript>&#x61;&#106;&#x69;&#46;&#122;&#x71;&#102;&#x61;&#110;&#32;&#x61;&#116;&#32;&#x67;&#x6d;&#x61;&#x69;&#108;&#32;&#100;&#x6f;&#116;&#32;&#x63;&#x6f;&#x6d;</noscript></p>
<h1 id="preface"><span class="header-section-number">1</span> 前言</h1>
<p>本文档描述OpenStack Ceilometer项目Havana版本ReST API V2，主要依据</p>
<ul>
<li>http://api.openstack.org/api-ref-telemetry.html</li>
<li>http://docs.openstack.org/developer/ceilometer/</li>
</ul>
<p>在SLES 11 SP3上对Ceilometer 2013.2.2进行验证，使用的数据库为mongodb。</p>
<p>文档修改历史</p>
<table>
<col width="12%" />
<col width="76%" />
<col width="10%" />
<thead>
<tr class="header">
<th align="left">修改时间</th>
<th align="left">修改概述</th>
<th align="left">修改者</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2014-02-19</td>
<td align="left">1、增加对请求uri中查询关键字取值value的说明；<br />2、修正对象模型的类型列；<br />3、修正若干错误。</td>
<td align="left">f00253402</td>
</tr>
<tr class="even">
<td align="left">2014-02-19</td>
<td align="left">1、文档json示例按照模板编写；<br />2、修正若干错误。</td>
<td align="left">f00253402</td>
</tr>
<tr class="odd">
<td align="left">2014-02-15</td>
<td align="left">1、修正了描述错误的接口，获取指定meter的statistics，由POST改为了GET；<br />2、文档整体结构按照模板填写；<br />3、将模型中未定义的字段由-改为了N/A；<br />4、进一步改善正确性和可使用性。</td>
<td align="left">f00253402</td>
</tr>
<tr class="even">
<td align="left">2014-02-11</td>
<td align="left">初稿</td>
<td align="left">f00253402</td>
</tr>
</tbody>
</table>
<h1 id="概述"><span class="header-section-number">2</span> 概述</h1>
<h2 id="词汇表"><span class="header-section-number">2.1</span> 词汇表</h2>
<table>
<thead>
<tr class="header">
<th align="left">名称</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">meter</td>
<td align="left">度量，指标</td>
</tr>
<tr class="even">
<td align="left">sample</td>
<td align="left">采样，数据点</td>
</tr>
<tr class="odd">
<td align="left">statistic</td>
<td align="left">统计</td>
</tr>
<tr class="even">
<td align="left">alarm</td>
<td align="left">告警</td>
</tr>
<tr class="odd">
<td align="left">Resource</td>
<td align="left">资源</td>
</tr>
</tbody>
</table>
<h1 id="对象模型"><span class="header-section-number">3</span> 对象模型</h1>
<p>Ceilometer Havana API V2管理如下对象</p>
<h2 id="resource"><span class="header-section-number">3.1</span> Resource</h2>
<ul>
<li>Resource属性表</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">CRUD</th>
<th align="left">默认值</th>
<th align="left">约束</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">resource_id</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">资源id，与其他服务中对应资源的id一致</td>
</tr>
<tr class="even">
<td align="left">project_id</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">项目id，即用户所在租户id</td>
</tr>
<tr class="odd">
<td align="left">user_id</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">用户id</td>
</tr>
<tr class="even">
<td align="left">source</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">来源，其他组件发出的rpc可能将其设置为openstack</td>
</tr>
<tr class="odd">
<td align="left">meter</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">此资源上的meter列表，最新havana分支中以冗余为由已被移除</td>
</tr>
<tr class="even">
<td align="left">first_sample_timestamp</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">datetime</td>
<td align="left">数据采集最初UTC时间</td>
</tr>
<tr class="odd">
<td align="left">last_sample_timestamp</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">datetime</td>
<td align="left">数据采集最近UTC时间</td>
</tr>
<tr class="even">
<td align="left">metadata</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">json dict</td>
<td align="left">资源元数据，格式化的json对象</td>
</tr>
</tbody>
</table>
<h2 id="meter"><span class="header-section-number">3.2</span> Meter</h2>
<p>Meter是资源可监测的类型，注：数据库中的meter表实际存储的是sample</p>
<ul>
<li>meter属性表</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">CRUD</th>
<th align="left">默认值</th>
<th align="left">约束</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">name</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">名称，唯一</td>
</tr>
<tr class="even">
<td align="left">type</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">见type取值表</td>
<td align="left">类型，只能为gauge，cumulative，delta之一</td>
</tr>
<tr class="odd">
<td align="left">unit</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">单位</td>
</tr>
<tr class="even">
<td align="left">resource_id</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">资源id</td>
</tr>
<tr class="odd">
<td align="left">project_id</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">项目id</td>
</tr>
<tr class="even">
<td align="left">source</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">来源</td>
</tr>
<tr class="odd">
<td align="left">user_id</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">用户id</td>
</tr>
</tbody>
</table>
<ul>
<li>type取值表</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">gauge</td>
<td align="left">离散值，如虚拟机个数</td>
</tr>
<tr class="even">
<td align="left">cumulative</td>
<td align="left">连续值，如网卡流量</td>
</tr>
<tr class="odd">
<td align="left">delta</td>
<td align="left">增量值，如进度条</td>
</tr>
</tbody>
</table>
<h2 id="sample"><span class="header-section-number">3.3</span> Sample</h2>
<p>Sample是一个数据点，可以理解为在某一时间点上对某个Meter的采样，对应数据库中的meter表。</p>
<ul>
<li>Sample属性表</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">CRUD</th>
<th align="left">默认值</th>
<th align="left">约束</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">source</td>
<td align="left">string</td>
<td align="left">cr</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">名称</td>
</tr>
<tr class="even">
<td align="left">counter_name</td>
<td align="left">string</td>
<td align="left">cr</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">meter名称</td>
</tr>
<tr class="odd">
<td align="left">counter_type</td>
<td align="left">string</td>
<td align="left">cr</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">meter类型</td>
</tr>
<tr class="even">
<td align="left">counter_unit</td>
<td align="left">string</td>
<td align="left">cr</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">meter单位</td>
</tr>
<tr class="odd">
<td align="left">counter_volume</td>
<td align="left">float</td>
<td align="left">cr</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">值</td>
</tr>
<tr class="even">
<td align="left">user_id</td>
<td align="left">string</td>
<td align="left">cr</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">用户id</td>
</tr>
<tr class="odd">
<td align="left">project_id</td>
<td align="left">string</td>
<td align="left">cr</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">项目id</td>
</tr>
<tr class="even">
<td align="left">resource_id</td>
<td align="left">string</td>
<td align="left">cr</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">资源id</td>
</tr>
<tr class="odd">
<td align="left">timestamp</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">datetime</td>
<td align="left">时间戳</td>
</tr>
<tr class="even">
<td align="left">resource_metadata</td>
<td align="left">string</td>
<td align="left">cr</td>
<td align="left">N/A</td>
<td align="left">json dict</td>
<td align="left">资源元数据</td>
</tr>
<tr class="odd">
<td align="left">message_id</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">消息id</td>
</tr>
<tr class="even">
<td align="left">message_signature</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">消息数据的hash值</td>
</tr>
</tbody>
</table>
<h2 id="statistics"><span class="header-section-number">3.4</span> Statistics</h2>
<p>Statistic是Sample的统计。</p>
<ul>
<li>Statistics属性表</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">CRUD</th>
<th align="left">默认值</th>
<th align="left">约束</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">unit</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">单位</td>
</tr>
<tr class="even">
<td align="left">min</td>
<td align="left">float</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">最小值</td>
</tr>
<tr class="odd">
<td align="left">max</td>
<td align="left">float</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">最大值</td>
</tr>
<tr class="even">
<td align="left">avg</td>
<td align="left">float</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">平均值</td>
</tr>
<tr class="odd">
<td align="left">sum</td>
<td align="left">float</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">总和</td>
</tr>
<tr class="even">
<td align="left">count</td>
<td align="left">int</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">数量</td>
</tr>
<tr class="odd">
<td align="left">period</td>
<td align="left">int</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">非负数</td>
<td align="left">周期，单位秒</td>
</tr>
<tr class="even">
<td align="left">period_start</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">datetime</td>
<td align="left">周期起始时间</td>
</tr>
<tr class="odd">
<td align="left">period_end</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">datetime</td>
<td align="left">周期结束时间</td>
</tr>
<tr class="even">
<td align="left">duration</td>
<td align="left">int</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">非负数</td>
<td align="left">持续时间</td>
</tr>
<tr class="odd">
<td align="left">duration_start</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">datetime</td>
<td align="left">持续时间起始时间</td>
</tr>
<tr class="even">
<td align="left">duration_end</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">datetime</td>
<td align="left">持续时间结束时</td>
</tr>
<tr class="odd">
<td align="left">groupby</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">sample分组</td>
</tr>
</tbody>
</table>
<h2 id="alarm"><span class="header-section-number">3.5</span> Alarm</h2>
<p>Alarm对应数据库alarm表</p>
<ul>
<li>Alarm属性表</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">CRUD</th>
<th align="left">默认值</th>
<th align="left">约束</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alarm_id</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">uuid</td>
</tr>
<tr class="even">
<td align="left">type</td>
<td align="left">string</td>
<td align="left">crw</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">类型，取值为threshold或combination</td>
</tr>
<tr class="odd">
<td align="left">name</td>
<td align="left">string</td>
<td align="left">crw</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">名称，项目内唯一</td>
</tr>
<tr class="even">
<td align="left">description</td>
<td align="left">string</td>
<td align="left">crw</td>
<td align="left">有</td>
<td align="left">N/A</td>
<td align="left">描述，默认值根据类型而不同</td>
</tr>
<tr class="odd">
<td align="left">enabled</td>
<td align="left">bool</td>
<td align="left">crw</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">是否可用</td>
</tr>
<tr class="even">
<td align="left">state</td>
<td align="left">string</td>
<td align="left">crw</td>
<td align="left">N/A</td>
<td align="left">见state取值表</td>
<td align="left">状态，取值为ok/alarm/insufficient data</td>
</tr>
<tr class="odd">
<td align="left">rule</td>
<td align="left">string</td>
<td align="left">crw</td>
<td align="left">N/A</td>
<td align="left">json dict</td>
<td align="left">条件，满足条件即触发alarm</td>
</tr>
<tr class="even">
<td align="left">user_id</td>
<td align="left">string</td>
<td align="left">crw</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">用户id</td>
</tr>
<tr class="odd">
<td align="left">project_id</td>
<td align="left">string</td>
<td align="left">crw</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">项目id</td>
</tr>
<tr class="even">
<td align="left">evaluation_periods</td>
<td align="left">string</td>
<td align="left">crw</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">时间窗口数量</td>
</tr>
<tr class="odd">
<td align="left">period</td>
<td align="left">int</td>
<td align="left">crw</td>
<td align="left">N/A</td>
<td align="left">非负数</td>
<td align="left">时间窗口，单位秒</td>
</tr>
<tr class="even">
<td align="left">timestamp</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">datetime</td>
<td align="left">最后一次更新的时间戳</td>
</tr>
<tr class="odd">
<td align="left">state_timestamp</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">datetime</td>
<td align="left">最后一次状态更新的时间戳</td>
</tr>
<tr class="even">
<td align="left">ok_actions</td>
<td align="left">string</td>
<td align="left">crw</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">alarm状态跃迁为ok时执行的动作</td>
</tr>
<tr class="odd">
<td align="left">alarm_actions</td>
<td align="left">string</td>
<td align="left">crw</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">alarm状态跃迁为alarm时执行的动作</td>
</tr>
<tr class="even">
<td align="left">insufficient_data_actions</td>
<td align="left">string</td>
<td align="left">crw</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">alarm状态跃迁为insufficient data时执行的动作</td>
</tr>
<tr class="odd">
<td align="left">repeat_actions</td>
<td align="left">bool</td>
<td align="left">crw</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">是否重复执行动作</td>
</tr>
</tbody>
</table>
<ul>
<li>state取值表</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ok</td>
<td align="left">正常</td>
</tr>
<tr class="even">
<td align="left">alarm</td>
<td align="left">警报</td>
</tr>
<tr class="odd">
<td align="left">insufficient data</td>
<td align="left">数据不正确</td>
</tr>
</tbody>
</table>
<h2 id="alarmchange"><span class="header-section-number">3.6</span> AlarmChange</h2>
<p>AlarmChange对应数据库alarm_history表。</p>
<ul>
<li>AlarmChange属性表</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">CRUD</th>
<th align="left">默认值</th>
<th align="left">约束</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">event_id</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">事件的uuid</td>
</tr>
<tr class="even">
<td align="left">alarm_id</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">alarm id</td>
</tr>
<tr class="odd">
<td align="left">type</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">alarm变动的类型</td>
</tr>
<tr class="even">
<td align="left">detail</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">alarm变动的细节</td>
</tr>
<tr class="odd">
<td align="left">user_id</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">用户id，alarm初始用户</td>
</tr>
<tr class="even">
<td align="left">project_id</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">项目id，alarm初始项目</td>
</tr>
<tr class="odd">
<td align="left">on_behalf_of</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
<td align="left">项目id，alarm变动后归属的项目</td>
</tr>
<tr class="even">
<td align="left">timestamp</td>
<td align="left">string</td>
<td align="left">r</td>
<td align="left">N/A</td>
<td align="left">datetime</td>
<td align="left">时间戳</td>
</tr>
</tbody>
</table>
<h1 id="api通用信息"><span class="header-section-number">4</span> API通用信息</h1>
<h2 id="获取token"><span class="header-section-number">4.1</span> 获取token</h2>
<p>Ceilometer API v2使用Keystone Identity Service作为默认的鉴权服务，用户向Ceilometer API发送请求，请求的HTTP Head中必须包括一个X-Auth-Token参数，X-Auth-Token的值必须是一个经过Keystone授权分配的token，通过Keystone分配token的方法，请查阅Keystone的接口文档。</p>
<p>HTTP 消息样例：</p>
<table>
<thead>
<tr class="header">
<th align="left">Element</th>
<th align="left">Content</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">HTTP HEAD</td>
<td align="left">X-Auth-Token：9c81513600564b31b32d5918963778b3 Content-type：application/json</td>
</tr>
<tr class="even">
<td align="left">HTTP BODY</td>
<td align="left">{...}</td>
</tr>
</tbody>
</table>
<h2 id="多租户支持"><span class="header-section-number">4.2</span> 多租户支持</h2>
<p>Ceilometer中大部分对象都具有租户属性，如果是资源相关的对象，租户属性从资源中取得，如果是Alarm对象，租户属性在创建、修改Alarm时由http头部信息中的X-Project-Id获得，或者在消息体中指定。</p>
<h1 id="api操作"><span class="header-section-number">5</span> API操作</h1>
<h2 id="资源resource"><span class="header-section-number">5.1</span> 资源（Resource）</h2>
<h3 id="查询资源list-resources"><span class="header-section-number">5.1.1</span> 查询资源（List Resources）</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GET</td>
<td align="left">/v2/resources?q.op={operator}&amp;q.value={value}&amp;q.field={field}</td>
<td align="left">获取Resource列表</td>
</tr>
</tbody>
</table>
<ul>
<li>request filter参数</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">q.op</td>
<td align="left">string</td>
<td align="left">见op可选值表</td>
<td align="left">No</td>
<td align="left">操作符</td>
</tr>
<tr class="even">
<td align="left">q.value</td>
<td align="left">string</td>
<td align="left">见value约束表</td>
<td align="left">No</td>
<td align="left">值</td>
</tr>
<tr class="odd">
<td align="left">q.field</td>
<td align="left">string</td>
<td align="left">见filed可选值表</td>
<td align="left">No</td>
<td align="left">查询关键字</td>
</tr>
</tbody>
</table>
<p>op可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">约束</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">eq</td>
<td align="left">field!=timpestamp</td>
<td align="left">等于</td>
</tr>
<tr class="even">
<td align="left">lt</td>
<td align="left">field=timestamp</td>
<td align="left">小于</td>
</tr>
<tr class="odd">
<td align="left">le</td>
<td align="left">field=timestamp</td>
<td align="left">小于等于</td>
</tr>
<tr class="even">
<td align="left">ge</td>
<td align="left">field=timestamp</td>
<td align="left">大于等于</td>
</tr>
<tr class="odd">
<td align="left">gt</td>
<td align="left">field=timestamp</td>
<td align="left">大于</td>
</tr>
</tbody>
</table>
<p>value约束表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">约束</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">任意合法时间字符串</td>
<td align="left">field=timpestamp</td>
<td align="left">至少形如yyyy-mm-dd，指定精确时间格式可以为yyyy-mm-ddThh:mm:ss，例如2014-02-17T03%3A01%3A05（已经经过url编码替换了特殊字符）</td>
</tr>
</tbody>
</table>
<p>field可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">resource</td>
<td align="left">资源id</td>
</tr>
<tr class="even">
<td align="left">project</td>
<td align="left">项目id</td>
</tr>
<tr class="odd">
<td align="left">user</td>
<td align="left">用户id</td>
</tr>
<tr class="even">
<td align="left">source</td>
<td align="left">来源名称</td>
</tr>
<tr class="odd">
<td align="left">timestamp</td>
<td align="left">时间戳，未定义但有效</td>
</tr>
<tr class="even">
<td align="left">start_timestamp</td>
<td align="left">起始时间戳，合法但无效</td>
</tr>
<tr class="odd">
<td align="left">end_timpestamp</td>
<td align="left">结束时间戳，合法但无效</td>
</tr>
<tr class="even">
<td align="left">start_timestamp_op</td>
<td align="left">起始时间戳操作符，合法但无效</td>
</tr>
<tr class="odd">
<td align="left">end_timpestamp_op</td>
<td align="left">结束时间戳操作符，合法但无效</td>
</tr>
<tr class="even">
<td align="left">metadata</td>
<td align="left">元数据，必须以metadata.{key}的形式出现，key的取值无约束</td>
</tr>
<tr class="odd">
<td align="left">pagination</td>
<td align="left">未实现</td>
</tr>
</tbody>
</table>
<ul>
<li>request body参数</li>
</ul>
<p>无</p>
<ul>
<li>response body参数</li>
</ul>
<p>待更新</p>
<ul>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/resources</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json"> [
     {
         <span class="dt">&quot;first_sample_timestamp&quot;</span>: <span class="st">&quot;2014-01-09T11:11:22.946000&quot;</span>,
         <span class="dt">&quot;last_sample_timestamp&quot;</span>: <span class="st">&quot;2014-01-09T11:11:22.946000&quot;</span>,
         <span class="dt">&quot;links&quot;</span>: [
             {
                 <span class="dt">&quot;href&quot;</span>: <span class="st">&quot;http://controller:8777/v2/resources/0f2ab214-103a-4111-919b-c0cdd03db629&quot;</span>,
                 <span class="dt">&quot;rel&quot;</span>: <span class="st">&quot;self&quot;</span>
             },
             {
                 <span class="dt">&quot;href&quot;</span>: <span class="st">&quot;http://controller:8777/v2/meters/network?q.field=resource_id&amp;q.value=0f2ab214-103a-4111-919b-c0cdd03db629&quot;</span>,
                 <span class="dt">&quot;rel&quot;</span>: <span class="st">&quot;network&quot;</span>
             },
             {
                 <span class="dt">&quot;href&quot;</span>: <span class="st">&quot;http://controller:8777/v2/meters/network.create?q.field=resource_id&amp;q.value=0f2ab214-103a-4111-919b-c0cdd03db629&quot;</span>,
                 <span class="dt">&quot;rel&quot;</span>: <span class="st">&quot;network.create&quot;</span>
             }
         ],
         <span class="dt">&quot;metadata&quot;</span>: {
             <span class="dt">&quot;admin_state_up&quot;</span>: <span class="st">&quot;True&quot;</span>,
             <span class="dt">&quot;event_type&quot;</span>: <span class="st">&quot;network.create.end&quot;</span>,
             <span class="dt">&quot;host&quot;</span>: <span class="st">&quot;network.aio&quot;</span>,
             <span class="dt">&quot;id&quot;</span>: <span class="st">&quot;0f2ab214-103a-4111-919b-c0cdd03db629&quot;</span>,
             <span class="dt">&quot;name&quot;</span>: <span class="st">&quot;int-net&quot;</span>,
             <span class="dt">&quot;provider:network_type&quot;</span>: <span class="st">&quot;local&quot;</span>,
             <span class="dt">&quot;provider:physical_network&quot;</span>: <span class="st">&quot;None&quot;</span>,
             <span class="dt">&quot;provider:segmentation_id&quot;</span>: <span class="st">&quot;None&quot;</span>,
             <span class="dt">&quot;shared&quot;</span>: <span class="st">&quot;False&quot;</span>,
             <span class="dt">&quot;status&quot;</span>: <span class="st">&quot;ACTIVE&quot;</span>,
             <span class="dt">&quot;tenant_id&quot;</span>: <span class="st">&quot;313a8bc21b994e60b93d6fff7c1e0c1b&quot;</span>
         },
         <span class="dt">&quot;project_id&quot;</span>: <span class="st">&quot;313a8bc21b994e60b93d6fff7c1e0c1b&quot;</span>,
         <span class="dt">&quot;resource_id&quot;</span>: <span class="st">&quot;0f2ab214-103a-4111-919b-c0cdd03db629&quot;</span>,
         <span class="dt">&quot;user_id&quot;</span>: <span class="st">&quot;30aee73695744a6096e35fdab25b6766&quot;</span>
     }
 ]</code></pre></td>
</tr>
</tbody>
</table>
<ul>
<li>过滤条件JSON请求样例，metaquery</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/resources?q.op=eq&amp;q.value=network.nonexistentHostName&amp;q.field=metadata.host</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>过滤条件JSON响应样例，metaquery</li>
</ul>
<p>由于metadata键值为host，值为nonexistentHostName的resource并不存在，输出为空</p>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">[]</code></pre></td>
</tr>
</tbody>
</table>
<h3 id="查询资源详情show-resource"><span class="header-section-number">5.1.2</span> 查询资源详情（Show Resource）</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GET</td>
<td align="left">/v2/resources/{resource_id}</td>
<td align="left">获取指定资源信息</td>
</tr>
</tbody>
</table>
<ul>
<li>request filter参数</li>
</ul>
<p>无</p>
<ul>
<li>request body参数</li>
</ul>
<p>无</p>
<ul>
<li>response body参数</li>
</ul>
<p>待更新</p>
<ul>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/resources/0f2ab214-103a-4111-919b-c0cdd03db629</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">{
   <span class="dt">&quot;first_sample_timestamp&quot;</span>: <span class="st">&quot;2014-01-09T11:11:22.946000&quot;</span>,
    <span class="dt">&quot;last_sample_timestamp&quot;</span>: <span class="st">&quot;2014-01-09T11:11:22.946000&quot;</span>,
    <span class="dt">&quot;links&quot;</span>: [
        {
            <span class="dt">&quot;href&quot;</span>: <span class="st">&quot;http://controller:8777/v2/resources/0f2ab214-103a-4111-919b-c0cdd03db629&quot;</span>,
            <span class="dt">&quot;rel&quot;</span>: <span class="st">&quot;self&quot;</span>
        },
        {
            <span class="dt">&quot;href&quot;</span>: <span class="st">&quot;http://controller:8777/v2/meters/network?q.field=resource_id&amp;q.value=0f2ab214-103a-4111-919b-c0cdd03db629&quot;</span>,
            <span class="dt">&quot;rel&quot;</span>: <span class="st">&quot;network&quot;</span>
        },
        {
            <span class="dt">&quot;href&quot;</span>: <span class="st">&quot;http://controller:8777/v2/meters/network.create?q.field=resource_id&amp;q.value=0f2ab214-103a-4111-919b-c0cdd03db629&quot;</span>,
            <span class="dt">&quot;rel&quot;</span>: <span class="st">&quot;network.create&quot;</span>
        }
    ],
    <span class="dt">&quot;metadata&quot;</span>: {
        <span class="dt">&quot;admin_state_up&quot;</span>: <span class="st">&quot;True&quot;</span>,
        <span class="dt">&quot;event_type&quot;</span>: <span class="st">&quot;network.create.end&quot;</span>,
        <span class="dt">&quot;host&quot;</span>: <span class="st">&quot;network.aio&quot;</span>,
        <span class="dt">&quot;id&quot;</span>: <span class="st">&quot;0f2ab214-103a-4111-919b-c0cdd03db629&quot;</span>,
        <span class="dt">&quot;name&quot;</span>: <span class="st">&quot;int-net&quot;</span>,
        <span class="dt">&quot;provider:network_type&quot;</span>: <span class="st">&quot;local&quot;</span>,
        <span class="dt">&quot;provider:physical_network&quot;</span>: <span class="st">&quot;None&quot;</span>,
        <span class="dt">&quot;provider:segmentation_id&quot;</span>: <span class="st">&quot;None&quot;</span>,
        <span class="dt">&quot;shared&quot;</span>: <span class="st">&quot;False&quot;</span>,
        <span class="dt">&quot;status&quot;</span>: <span class="st">&quot;ACTIVE&quot;</span>,
        <span class="dt">&quot;tenant_id&quot;</span>: <span class="st">&quot;313a8bc21b994e60b93d6fff7c1e0c1b&quot;</span>
    },
    <span class="dt">&quot;project_id&quot;</span>: <span class="st">&quot;313a8bc21b994e60b93d6fff7c1e0c1b&quot;</span>,
    <span class="dt">&quot;resource_id&quot;</span>: <span class="st">&quot;0f2ab214-103a-4111-919b-c0cdd03db629&quot;</span>,
    <span class="dt">&quot;user_id&quot;</span>: <span class="st">&quot;30aee73695744a6096e35fdab25b6766&quot;</span>
}</code></pre></td>
</tr>
</tbody>
</table>
<h2 id="度量meter"><span class="header-section-number">5.2</span> 度量（Meter）</h2>
<h3 id="查询度量list-meters"><span class="header-section-number">5.2.1</span> 查询度量（List Meters）</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GET</td>
<td align="left">/v2/meters?q.op=eq&amp;q.value={value}&amp;q.field={field}</td>
<td align="left">获取Meter列表</td>
</tr>
</tbody>
</table>
<ul>
<li>request filter参数</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">q.op</td>
<td align="left">string</td>
<td align="left">只能为eq</td>
<td align="left">No</td>
<td align="left">操作符</td>
</tr>
<tr class="even">
<td align="left">q.value</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">No</td>
<td align="left">值</td>
</tr>
<tr class="odd">
<td align="left">q.field</td>
<td align="left">string</td>
<td align="left">见filed可选值表</td>
<td align="left">No</td>
<td align="left">查询关键字</td>
</tr>
</tbody>
</table>
<p>field可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">resource</td>
<td align="left">资源id</td>
</tr>
<tr class="even">
<td align="left">project</td>
<td align="left">项目id</td>
</tr>
<tr class="odd">
<td align="left">user</td>
<td align="left">用户id</td>
</tr>
<tr class="even">
<td align="left">source</td>
<td align="left">来源名称</td>
</tr>
<tr class="odd">
<td align="left">metadata</td>
<td align="left">元数据，无效</td>
</tr>
<tr class="even">
<td align="left">pagination</td>
<td align="left">未实现</td>
</tr>
</tbody>
</table>
<ul>
<li>request body参数</li>
</ul>
<p>无</p>
<ul>
<li><p>response body参数 待更新</p></li>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/meters</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">[
    {
        <span class="dt">&quot;meter_id&quot;</span>: <span class="st">&quot;MTEzNDcwMmQtNDcxZS00MjYwLWEzNWMtMTk3Mzg5OTI2MzZiK2ltYWdl\n&quot;</span>,
        <span class="dt">&quot;name&quot;</span>: <span class="st">&quot;image&quot;</span>,
        <span class="dt">&quot;project_id&quot;</span>: <span class="st">&quot;313a8bc21b994e60b93d6fff7c1e0c1b&quot;</span>,
        <span class="dt">&quot;resource_id&quot;</span>: <span class="st">&quot;1134702d-471e-4260-a35c-19738992636b&quot;</span>,
        <span class="dt">&quot;source&quot;</span>: <span class="st">&quot;openstack&quot;</span>,
        <span class="dt">&quot;type&quot;</span>: <span class="st">&quot;gauge&quot;</span>,
        <span class="dt">&quot;unit&quot;</span>: <span class="st">&quot;image&quot;</span>,
        <span class="dt">&quot;user_id&quot;</span>: <span class="dv">null</span>
    }
]</code></pre></td>
</tr>
</tbody>
</table>
<ul>
<li>过滤条件JSON请求样例，source</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/meters?q.op=eq&amp;q.value=orcs&amp;q.field=source</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>过滤条件JSON响应样例，source</li>
</ul>
<p>由于来源自orcs的meter并不存在，输出为空</p>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">[]</code></pre></td>
</tr>
</tbody>
</table>
<h2 id="数据点sample"><span class="header-section-number">5.3</span> 数据点（Sample）</h2>
<h3 id="查询数据点list-samples"><span class="header-section-number">5.3.1</span> 查询数据点（List Samples）</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GET</td>
<td align="left">/v2/meters/{meter_name}?limit={value}&amp;q.op=eq&amp;q.value={value}&amp;q.field={field}</td>
<td align="left">获取指定Meter下所有的数据点</td>
</tr>
</tbody>
</table>
<ul>
<li>request filter参数</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">q.op</td>
<td align="left">string</td>
<td align="left">只能为eq</td>
<td align="left">No</td>
<td align="left">操作符</td>
</tr>
<tr class="even">
<td align="left">q.value</td>
<td align="left">string</td>
<td align="left">见value约束表</td>
<td align="left">No</td>
<td align="left">值</td>
</tr>
<tr class="odd">
<td align="left">q.field</td>
<td align="left">string</td>
<td align="left">见filed可选值表</td>
<td align="left">No</td>
<td align="left">查询关键字</td>
</tr>
<tr class="even">
<td align="left">limit</td>
<td align="left">int</td>
<td align="left">必须为非负数</td>
<td align="left">No</td>
<td align="left">返回结果数</td>
</tr>
</tbody>
</table>
<p>value约束表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">约束</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">任意合法时间字符串</td>
<td align="left">field={start,end}</td>
<td align="left">至少形如yyyy-mm-dd，指定精确时间格式可以为yyyy-mm-ddThh:mm:ss，例如2014-02-17T03%3A01%3A05（已经经过url编码替换了特殊字符）</td>
</tr>
</tbody>
</table>
<p>field可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">约束</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">resource</td>
<td align="left">N/A</td>
<td align="left">资源id</td>
</tr>
<tr class="even">
<td align="left">project</td>
<td align="left">N/A</td>
<td align="left">项目id</td>
</tr>
<tr class="odd">
<td align="left">user</td>
<td align="left">N/A</td>
<td align="left">用户id</td>
</tr>
<tr class="even">
<td align="left">source</td>
<td align="left">N/A</td>
<td align="left">来源名称</td>
</tr>
<tr class="odd">
<td align="left">start</td>
<td align="left">N/A</td>
<td align="left">起始时间戳</td>
</tr>
<tr class="even">
<td align="left">end</td>
<td align="left">N/A</td>
<td align="left">结束时间戳</td>
</tr>
<tr class="odd">
<td align="left">start_timestamp_op</td>
<td align="left">见tsop可选值表</td>
<td align="left">起始时间戳操作符</td>
</tr>
<tr class="even">
<td align="left">end_timpestamp_op</td>
<td align="left">见tsop可选值表</td>
<td align="left">结束时间戳操作符</td>
</tr>
<tr class="odd">
<td align="left">metadata</td>
<td align="left">N/A</td>
<td align="left">元数据，形如metadata.{key}，key取值无限制</td>
</tr>
<tr class="even">
<td align="left">meter</td>
<td align="left">N/A</td>
<td align="left">度量</td>
</tr>
</tbody>
</table>
<p>见tsop可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">eq</td>
<td align="left">等于</td>
</tr>
<tr class="even">
<td align="left">lt</td>
<td align="left">小于</td>
</tr>
<tr class="odd">
<td align="left">le</td>
<td align="left">小于等于</td>
</tr>
<tr class="even">
<td align="left">ge</td>
<td align="left">大于等于</td>
</tr>
<tr class="odd">
<td align="left">gt</td>
<td align="left">大于</td>
</tr>
</tbody>
</table>
<ul>
<li>request body参数</li>
</ul>
<p>无</p>
<ul>
<li>response body参数</li>
</ul>
<p>待更新</p>
<ul>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/meters/router</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">[
    {
        <span class="dt">&quot;counter_name&quot;</span>: <span class="st">&quot;router&quot;</span>,
        <span class="dt">&quot;counter_type&quot;</span>: <span class="st">&quot;gauge&quot;</span>,
        <span class="dt">&quot;counter_unit&quot;</span>: <span class="st">&quot;router&quot;</span>,
        <span class="dt">&quot;counter_volume&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;message_id&quot;</span>: <span class="st">&quot;dbfb95b6-791e-11e3-866f-548998f6e71d&quot;</span>,
        <span class="dt">&quot;project_id&quot;</span>: <span class="st">&quot;313a8bc21b994e60b93d6fff7c1e0c1b&quot;</span>,
        <span class="dt">&quot;resource_id&quot;</span>: <span class="st">&quot;a67d5d0d-1ad1-4402-99be-192b946dd5cc&quot;</span>,
        <span class="dt">&quot;resource_metadata&quot;</span>: {
            <span class="dt">&quot;admin_state_up&quot;</span>: <span class="st">&quot;True&quot;</span>,
            <span class="dt">&quot;event_type&quot;</span>: <span class="st">&quot;router.create.end&quot;</span>,
            <span class="dt">&quot;external_gateway_info&quot;</span>: <span class="st">&quot;None&quot;</span>,
            <span class="dt">&quot;host&quot;</span>: <span class="st">&quot;network.aio&quot;</span>,
            <span class="dt">&quot;id&quot;</span>: <span class="st">&quot;a67d5d0d-1ad1-4402-99be-192b946dd5cc&quot;</span>,
            <span class="dt">&quot;name&quot;</span>: <span class="st">&quot;admin-router&quot;</span>,
            <span class="dt">&quot;status&quot;</span>: <span class="st">&quot;ACTIVE&quot;</span>,
            <span class="dt">&quot;tenant_id&quot;</span>: <span class="st">&quot;313a8bc21b994e60b93d6fff7c1e0c1b&quot;</span>
        },
        <span class="dt">&quot;source&quot;</span>: <span class="st">&quot;openstack&quot;</span>,
        <span class="dt">&quot;timestamp&quot;</span>: <span class="st">&quot;2014-01-09T11:11:59.772000&quot;</span>,
        <span class="dt">&quot;user_id&quot;</span>: <span class="st">&quot;30aee73695744a6096e35fdab25b6766&quot;</span>
    }
]</code></pre></td>
</tr>
</tbody>
</table>
<ul>
<li>过滤条件JSON请求样例，limit</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/meters/router?limit=1</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>过滤条件JSON响应样例，limit</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">[
    {
        <span class="dt">&quot;counter_name&quot;</span>: <span class="st">&quot;instance&quot;</span>,
        <span class="dt">&quot;counter_type&quot;</span>: <span class="st">&quot;gauge&quot;</span>,
        <span class="dt">&quot;counter_unit&quot;</span>: <span class="st">&quot;instance&quot;</span>,
        <span class="dt">&quot;counter_volume&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;message_id&quot;</span>: <span class="st">&quot;c4841b8c-91b1-11e3-b763-548998f6e71d&quot;</span>,
        <span class="dt">&quot;project_id&quot;</span>: <span class="st">&quot;313a8bc21b994e60b93d6fff7c1e0c1b&quot;</span>,
        <span class="dt">&quot;resource_id&quot;</span>: <span class="st">&quot;7fd9bc47-dfbf-418f-9355-4650f32a0456&quot;</span>,
        <span class="dt">&quot;resource_metadata&quot;</span>: {
            <span class="dt">&quot;OS-EXT-AZ:availability_zone&quot;</span>: <span class="st">&quot;nova&quot;</span>,
            <span class="dt">&quot;disk_gb&quot;</span>: <span class="st">&quot;1&quot;</span>,
            <span class="dt">&quot;display_name&quot;</span>: <span class="st">&quot;test&quot;</span>,
            <span class="dt">&quot;ephemeral_gb&quot;</span>: <span class="st">&quot;0&quot;</span>,
            <span class="dt">&quot;flavor.disk&quot;</span>: <span class="st">&quot;1&quot;</span>,
            <span class="dt">&quot;flavor.ephemeral&quot;</span>: <span class="st">&quot;0&quot;</span>,
            <span class="dt">&quot;flavor.id&quot;</span>: <span class="st">&quot;1&quot;</span>,
            <span class="dt">&quot;flavor.name&quot;</span>: <span class="st">&quot;m1.tiny&quot;</span>,
            <span class="dt">&quot;flavor.ram&quot;</span>: <span class="st">&quot;512&quot;</span>,
            <span class="dt">&quot;flavor.vcpus&quot;</span>: <span class="st">&quot;1&quot;</span>,
            <span class="dt">&quot;host&quot;</span>: <span class="st">&quot;53ae8c96454e4c700e3d3fa28beb66d17157b7ea501d47a08cb8540c&quot;</span>,
            <span class="dt">&quot;image.id&quot;</span>: <span class="st">&quot;d338a0f7-ef81-43bb-b098-7de14fd1449d&quot;</span>,
            <span class="dt">&quot;image.name&quot;</span>: <span class="st">&quot;cirros0.3.1&quot;</span>,
            <span class="dt">&quot;image_ref&quot;</span>: <span class="st">&quot;d338a0f7-ef81-43bb-b098-7de14fd1449d&quot;</span>,
            <span class="dt">&quot;image_ref_url&quot;</span>: <span class="st">&quot;http://controller:8774/aebb7f33b7fc4cf486d3a2cdacac8ac1/images/d338a0f7-ef81-43bb-b098-7de14fd1449d&quot;</span>,
            <span class="dt">&quot;instance_type&quot;</span>: <span class="st">&quot;1&quot;</span>,
            <span class="dt">&quot;kernel_id&quot;</span>: <span class="st">&quot;None&quot;</span>,
            <span class="dt">&quot;memory_mb&quot;</span>: <span class="st">&quot;512&quot;</span>,
            <span class="dt">&quot;name&quot;</span>: <span class="st">&quot;instance-00000016&quot;</span>,
            <span class="dt">&quot;ramdisk_id&quot;</span>: <span class="st">&quot;None&quot;</span>,
            <span class="dt">&quot;root_gb&quot;</span>: <span class="st">&quot;1&quot;</span>,
            <span class="dt">&quot;vcpus&quot;</span>: <span class="st">&quot;1&quot;</span>
        },
        <span class="dt">&quot;source&quot;</span>: <span class="st">&quot;openstack&quot;</span>,
        <span class="dt">&quot;timestamp&quot;</span>: <span class="st">&quot;2014-02-09T17:44:04&quot;</span>,
        <span class="dt">&quot;user_id&quot;</span>: <span class="st">&quot;30aee73695744a6096e35fdab25b6766&quot;</span>
    }
]</code></pre></td>
</tr>
</tbody>
</table>
<h3 id="创建数据点create-sample"><span class="header-section-number">5.3.2</span> 创建数据点（Create Sample）</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">POST</td>
<td align="left">/v2/meters/{meter_name}</td>
<td align="left">为指定Meter创建数据点</td>
</tr>
</tbody>
</table>
<ul>
<li>request filter参数</li>
</ul>
<p>无</p>
<ul>
<li>request body参数</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N/A</td>
<td align="left">list</td>
<td align="left">N/A</td>
<td align="left">Yes</td>
<td align="left">Sample数据</td>
</tr>
</tbody>
</table>
<p>Sample结构</p>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">counter_name</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">YES</td>
<td align="left">度量名称</td>
</tr>
<tr class="even">
<td align="left">counter_type</td>
<td align="left">string</td>
<td align="left">见counter可选值表</td>
<td align="left">YES</td>
<td align="left">度量类型</td>
</tr>
<tr class="odd">
<td align="left">counter_unit</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">YES</td>
<td align="left">度量单位</td>
</tr>
<tr class="even">
<td align="left">counter_volume</td>
<td align="left">float</td>
<td align="left">N/A</td>
<td align="left">YES</td>
<td align="left">度量值，可以取负数！</td>
</tr>
<tr class="odd">
<td align="left">resource_id</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">YES</td>
<td align="left">资源id</td>
</tr>
<tr class="even">
<td align="left">project_id</td>
<td align="left">string</td>
<td align="left">admin可指定</td>
<td align="left">NO</td>
<td align="left">项目id</td>
</tr>
<tr class="odd">
<td align="left">user_id</td>
<td align="left">string</td>
<td align="left">admin可指定</td>
<td align="left">NO</td>
<td align="left">用户id</td>
</tr>
<tr class="even">
<td align="left">resource_metadata</td>
<td align="left">string</td>
<td align="left">json dict</td>
<td align="left">NO</td>
<td align="left">资源元数据</td>
</tr>
<tr class="odd">
<td align="left">timestamp</td>
<td align="left">string</td>
<td align="left">datetime</td>
<td align="left">NO</td>
<td align="left">时间戳</td>
</tr>
<tr class="even">
<td align="left">message_signature</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">NO</td>
<td align="left">消息签名，可以设置但没有效果</td>
</tr>
</tbody>
</table>
<p>couter_type可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">gauge</td>
<td align="left">离散值，如虚拟机个数</td>
</tr>
<tr class="even">
<td align="left">cumulative</td>
<td align="left">连续值，如网卡流量</td>
</tr>
<tr class="odd">
<td align="left">delta</td>
<td align="left">增量值，如进度条</td>
</tr>
</tbody>
</table>
<ul>
<li>response body参数</li>
</ul>
<p>待更新</p>
<ul>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">POST /v2/meters/router</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">[
    {
        <span class="dt">&quot;counter_name&quot;</span>: <span class="st">&quot;router&quot;</span>,
        <span class="dt">&quot;counter_type&quot;</span>: <span class="st">&quot;gauge&quot;</span>,
        <span class="dt">&quot;counter_unit&quot;</span>: <span class="st">&quot;router&quot;</span>,
        <span class="dt">&quot;counter_volume&quot;</span>: <span class="st">&quot;-1&quot;</span>,
        <span class="dt">&quot;resource_id&quot;</span>: <span class="st">&quot;x&quot;</span>
    }
]</code></pre></td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<p>HTTP POST成功一般会返回CODE 201 CREATED，此处ceilometer返回200也是可以的</p>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">[
    {
        <span class="dt">&quot;counter_name&quot;</span>: <span class="st">&quot;router&quot;</span>,
        <span class="dt">&quot;counter_type&quot;</span>: <span class="st">&quot;gauge&quot;</span>,
        <span class="dt">&quot;counter_unit&quot;</span>: <span class="st">&quot;router&quot;</span>,
        <span class="dt">&quot;counter_volume&quot;</span>: <span class="fl">-1.0</span>,
        <span class="dt">&quot;message_id&quot;</span>: <span class="st">&quot;90919fdc-927b-11e3-9310-548998f6e71d&quot;</span>,
        <span class="dt">&quot;project_id&quot;</span>: <span class="st">&quot;313a8bc21b994e60b93d6fff7c1e0c1b&quot;</span>,
        <span class="dt">&quot;resource_id&quot;</span>: <span class="st">&quot;x&quot;</span>,
        <span class="dt">&quot;resource_metadata&quot;</span>: {},
        <span class="dt">&quot;source&quot;</span>: <span class="st">&quot;313a8bc21b994e60b93d6fff7c1e0c1b:openstack&quot;</span>,
        <span class="dt">&quot;timestamp&quot;</span>: <span class="st">&quot;2014-02-10T17:48:35.533491&quot;</span>,
        <span class="dt">&quot;user_id&quot;</span>: <span class="st">&quot;30aee73695744a6096e35fdab25b6766&quot;</span>
    }
]</code></pre></td>
</tr>
</tbody>
</table>
<h2 id="统计statistics"><span class="header-section-number">5.4</span> 统计（Statistics）</h2>
<h3 id="查询统计show-statistics"><span class="header-section-number">5.4.1</span> 查询统计（Show Statistics）</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GET</td>
<td align="left">/v2/meters/{meter_name}/statistics?period={value}&amp; q.op=eq&amp;q.value={value}&amp;q.field={field}&amp;groupby={value}</td>
<td align="left">获取指定meter的统计信息</td>
</tr>
</tbody>
</table>
<ul>
<li>request filter参数</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">q.op</td>
<td align="left">string</td>
<td align="left">只能为eq</td>
<td align="left">No</td>
<td align="left">操作符</td>
</tr>
<tr class="even">
<td align="left">q.value</td>
<td align="left">string</td>
<td align="left">见value约束表</td>
<td align="left">No</td>
<td align="left">值</td>
</tr>
<tr class="odd">
<td align="left">q.field</td>
<td align="left">string</td>
<td align="left">见filed可选值表</td>
<td align="left">No</td>
<td align="left">查询关键字</td>
</tr>
<tr class="even">
<td align="left">period</td>
<td align="left">int</td>
<td align="left">非负整数</td>
<td align="left">No</td>
<td align="left">间隔</td>
</tr>
<tr class="odd">
<td align="left">groupby</td>
<td align="left">string</td>
<td align="left">见groupby可选值表</td>
<td align="left">No</td>
<td align="left">分组</td>
</tr>
</tbody>
</table>
<p>value约束表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">约束</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">任意合法时间字符串</td>
<td align="left">field={start,end}</td>
<td align="left">至少形如yyyy-mm-dd，指定精确时间格式可以为yyyy-mm-ddThh:mm:ss，例如2014-02-17T03%3A01%3A05（已经经过url编码替换了特殊字符）</td>
</tr>
</tbody>
</table>
<p>field可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">resource</td>
<td align="left">资源id</td>
</tr>
<tr class="even">
<td align="left">project</td>
<td align="left">项目id</td>
</tr>
<tr class="odd">
<td align="left">user</td>
<td align="left">用户id</td>
</tr>
<tr class="even">
<td align="left">source</td>
<td align="left">来源名称</td>
</tr>
<tr class="odd">
<td align="left">start</td>
<td align="left">起始时间戳</td>
</tr>
<tr class="even">
<td align="left">end</td>
<td align="left">结束时间戳</td>
</tr>
<tr class="odd">
<td align="left">start_timestamp_op</td>
<td align="left">起始时间戳操作符，见tsop可选值表</td>
</tr>
<tr class="even">
<td align="left">end_timpestamp_op</td>
<td align="left">结束时间戳操作符，见tsop可选值表</td>
</tr>
<tr class="odd">
<td align="left">metadata</td>
<td align="left">元数据，形如metadata.{key}，key取值无限制</td>
</tr>
<tr class="even">
<td align="left">meter</td>
<td align="left">无效</td>
</tr>
</tbody>
</table>
<p>tsop可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">eq</td>
<td align="left">等于</td>
</tr>
<tr class="even">
<td align="left">lt</td>
<td align="left">小于</td>
</tr>
<tr class="odd">
<td align="left">le</td>
<td align="left">小于等于</td>
</tr>
<tr class="even">
<td align="left">ge</td>
<td align="left">大于等于</td>
</tr>
<tr class="odd">
<td align="left">gt</td>
<td align="left">大于</td>
</tr>
</tbody>
</table>
<p>groupby可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">resource_id</td>
<td align="left">资源id</td>
</tr>
<tr class="even">
<td align="left">project_id</td>
<td align="left">项目id</td>
</tr>
<tr class="odd">
<td align="left">user_id</td>
<td align="left">用户id</td>
</tr>
<tr class="even">
<td align="left">source</td>
<td align="left">来源</td>
</tr>
</tbody>
</table>
<ul>
<li>request body参数</li>
</ul>
<p>无</p>
<ul>
<li>response body参数</li>
</ul>
<p>待更新</p>
<ul>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/meters/router/statistics</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">[
    {
        <span class="dt">&quot;avg&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;count&quot;</span>: <span class="dv">1</span>,
        <span class="dt">&quot;duration&quot;</span>: <span class="fl">0.0</span>,
        <span class="dt">&quot;duration_end&quot;</span>: <span class="st">&quot;2014-01-09T11:11:59.772000&quot;</span>,
        <span class="dt">&quot;duration_start&quot;</span>: <span class="st">&quot;2014-01-09T11:11:59.772000&quot;</span>,
        <span class="dt">&quot;groupby&quot;</span>: <span class="dv">null</span>,
        <span class="dt">&quot;max&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;min&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;period&quot;</span>: <span class="dv">0</span>,
        <span class="dt">&quot;period_end&quot;</span>: <span class="st">&quot;2014-01-09T11:11:59.772000&quot;</span>,
        <span class="dt">&quot;period_start&quot;</span>: <span class="st">&quot;2014-01-09T11:11:59.772000&quot;</span>,
        <span class="dt">&quot;sum&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;unit&quot;</span>: <span class="st">&quot;router&quot;</span>
    }
]</code></pre></td>
</tr>
</tbody>
</table>
<ul>
<li>过滤条件JSON请求样例，period</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/meters/router/statistics?period=10</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>过滤条件JSON响应样例，period</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">[
    {
        <span class="dt">&quot;avg&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;count&quot;</span>: <span class="dv">1</span>,
        <span class="dt">&quot;duration&quot;</span>: <span class="fl">0.0</span>,
        <span class="dt">&quot;duration_end&quot;</span>: <span class="st">&quot;2014-01-09T11:11:59.772000&quot;</span>,
        <span class="dt">&quot;duration_start&quot;</span>: <span class="st">&quot;2014-01-09T11:11:59.772000&quot;</span>,
        <span class="dt">&quot;groupby&quot;</span>: <span class="dv">null</span>,
        <span class="dt">&quot;max&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;min&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;period&quot;</span>: <span class="dv">10</span>,
        <span class="dt">&quot;period_end&quot;</span>: <span class="st">&quot;2014-01-09T11:12:08&quot;</span>,
        <span class="dt">&quot;period_start&quot;</span>: <span class="st">&quot;2014-01-09T11:11:58&quot;</span>,
        <span class="dt">&quot;sum&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;unit&quot;</span>: <span class="st">&quot;router&quot;</span>
    }
]</code></pre></td>
</tr>
</tbody>
</table>
<ul>
<li>过滤条件JSON请求样例，groupby</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/meters/router/statistics?groupby=resource_id</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>过滤条件JSON响应样例，groupby</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">[
    {
        <span class="dt">&quot;avg&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;count&quot;</span>: <span class="dv">1</span>,
        <span class="dt">&quot;duration&quot;</span>: <span class="fl">0.0</span>,
        <span class="dt">&quot;duration_end&quot;</span>: <span class="st">&quot;2014-01-09T11:11:59.772000&quot;</span>,
        <span class="dt">&quot;duration_start&quot;</span>: <span class="st">&quot;2014-01-09T11:11:59.772000&quot;</span>,
        <span class="dt">&quot;groupby&quot;</span>: {
            <span class="dt">&quot;resource_id&quot;</span>: <span class="st">&quot;a67d5d0d-1ad1-4402-99be-192b946dd5cc&quot;</span>
        },
        <span class="dt">&quot;max&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;min&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;period&quot;</span>: <span class="dv">0</span>,
        <span class="dt">&quot;period_end&quot;</span>: <span class="st">&quot;2014-01-09T11:11:59.772000&quot;</span>,
        <span class="dt">&quot;period_start&quot;</span>: <span class="st">&quot;2014-01-09T11:11:59.772000&quot;</span>,
        <span class="dt">&quot;sum&quot;</span>: <span class="fl">1.0</span>,
        <span class="dt">&quot;unit&quot;</span>: <span class="st">&quot;router&quot;</span>
    }
]</code></pre></td>
</tr>
</tbody>
</table>
<h2 id="告警alarm"><span class="header-section-number">5.5</span> 告警（Alarm）</h2>
<h3 id="查询告警list-alarms"><span class="header-section-number">5.5.1</span> 查询告警（List Alarms）</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GET</td>
<td align="left">/v2/alarms?q.op=eq&amp;q.value={value}&amp;q.field={field}</td>
<td align="left">获取alarm列表</td>
</tr>
</tbody>
</table>
<ul>
<li>request filter参数</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">q.op</td>
<td align="left">string</td>
<td align="left">只能为eq</td>
<td align="left">No</td>
<td align="left">操作符</td>
</tr>
<tr class="even">
<td align="left">q.value</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">No</td>
<td align="left">值</td>
</tr>
<tr class="odd">
<td align="left">q.field</td>
<td align="left">string</td>
<td align="left">见filed可选值表</td>
<td align="left">No</td>
<td align="left">查询关键字</td>
</tr>
</tbody>
</table>
<p>field可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">Value类型</th>
<th align="left">约束</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alarm_id</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">告警id</td>
</tr>
<tr class="even">
<td align="left">project</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">项目id</td>
</tr>
<tr class="odd">
<td align="left">user</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">用户id</td>
</tr>
<tr class="even">
<td align="left">name</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">名称</td>
</tr>
<tr class="odd">
<td align="left">enabled</td>
<td align="left">string</td>
<td align="left">见enabled约束表</td>
<td align="left">是否启用</td>
</tr>
<tr class="even">
<td align="left">pagination</td>
<td align="left">int</td>
<td align="left">N/A</td>
<td align="left">未实现</td>
</tr>
</tbody>
</table>
<p>enabled取值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">t, true, on, y, yes, 1</td>
<td align="left">大小写不敏感，取值为True</td>
</tr>
<tr class="even">
<td align="left">其他</td>
<td align="left">取值为False</td>
</tr>
</tbody>
</table>
<ul>
<li>request body参数</li>
</ul>
<p>无</p>
<ul>
<li>response body参数</li>
</ul>
<p>待更新</p>
<ul>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/alarms</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">[
    {
        <span class="dt">&quot;alarm_actions&quot;</span>: [],
        <span class="dt">&quot;alarm_id&quot;</span>: <span class="st">&quot;7505cd03-dc0f-4539-9906-d019783148fe&quot;</span>,
        <span class="dt">&quot;description&quot;</span>: <span class="st">&quot;Alarm when instance is eq a avg of 5.0 over 60 seconds&quot;</span>,
        <span class="dt">&quot;enabled&quot;</span>: <span class="dv">true</span>,
        <span class="dt">&quot;insufficient_data_actions&quot;</span>: [],
        <span class="dt">&quot;name&quot;</span>: <span class="st">&quot;test-member-create-alarm&quot;</span>,
        <span class="dt">&quot;ok_actions&quot;</span>: [],
        <span class="dt">&quot;project_id&quot;</span>: <span class="st">&quot;aebb7f33b7fc4cf486d3a2cdacac8ac1&quot;</span>,
        <span class="dt">&quot;repeat_actions&quot;</span>: <span class="dv">false</span>,
        <span class="dt">&quot;state&quot;</span>: <span class="st">&quot;insufficient data&quot;</span>,
        <span class="dt">&quot;state_timestamp&quot;</span>: <span class="st">&quot;2014-02-08T10:07:03.870000&quot;</span>,
        <span class="dt">&quot;threshold_rule&quot;</span>: {
            <span class="dt">&quot;comparison_operator&quot;</span>: <span class="st">&quot;eq&quot;</span>,
            <span class="dt">&quot;evaluation_periods&quot;</span>: <span class="dv">1</span>,
            <span class="dt">&quot;meter_name&quot;</span>: <span class="st">&quot;instance&quot;</span>,
            <span class="dt">&quot;period&quot;</span>: <span class="dv">60</span>,
            <span class="dt">&quot;query&quot;</span>: [
                {
                    <span class="dt">&quot;field&quot;</span>: <span class="st">&quot;project_id&quot;</span>,
                    <span class="dt">&quot;op&quot;</span>: <span class="st">&quot;eq&quot;</span>,
                    <span class="dt">&quot;value&quot;</span>: <span class="st">&quot;aebb7f33b7fc4cf486d3a2cdacac8ac1&quot;</span>
                }
            ],
            <span class="dt">&quot;statistic&quot;</span>: <span class="st">&quot;avg&quot;</span>,
            <span class="dt">&quot;threshold&quot;</span>: <span class="fl">5.0</span>
        },
        <span class="dt">&quot;timestamp&quot;</span>: <span class="st">&quot;2014-02-08T10:07:03.870000&quot;</span>,
        <span class="dt">&quot;type&quot;</span>: <span class="st">&quot;threshold&quot;</span>,
        <span class="dt">&quot;user_id&quot;</span>: <span class="st">&quot;f86eeee169ed48cf892ceac3d5e27a9f&quot;</span>
    }
]</code></pre></td>
</tr>
</tbody>
</table>
<ul>
<li>过滤条件JSON请求样例，enabled</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/alarms?q.op=eq&amp;q.value=true&amp;q.field=enabled</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>过滤条件JSON响应样例，enabled</li>
</ul>
<p>由于测试环境中不具有enabled=false的alarm，此处输出为空</p>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">[]</code></pre></td>
</tr>
</tbody>
</table>
<h3 id="创建告警create-alarm"><span class="header-section-number">5.5.2</span> 创建告警（Create Alarm）</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">POST</td>
<td align="left">/v2/alarms</td>
<td align="left">创建alarm</td>
</tr>
</tbody>
</table>
<ul>
<li>request filter参数</li>
</ul>
<p>无</p>
<ul>
<li>request body参数</li>
</ul>
<p><strong>注意，非必选参数未经验证！！</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N/A</td>
<td align="left">string</td>
<td align="left">json dict</td>
<td align="left">YES</td>
<td align="left">Alarm数据</td>
</tr>
</tbody>
</table>
<p>Alarm结构体</p>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">name</td>
<td align="left">string</td>
<td align="left">唯一</td>
<td align="left">YES</td>
<td align="left">名称</td>
</tr>
<tr class="even">
<td align="left">type</td>
<td align="left">string</td>
<td align="left">见type可选值表</td>
<td align="left">YES</td>
<td align="left">类型</td>
</tr>
<tr class="odd">
<td align="left">threshold_rule</td>
<td align="left">string</td>
<td align="left">json dict，当type=threshold时需指定</td>
<td align="left">YES</td>
<td align="left">阈值规则</td>
</tr>
<tr class="even">
<td align="left">combination_rule</td>
<td align="left">string</td>
<td align="left">json dict，当type=combination时需指定</td>
<td align="left">YES</td>
<td align="left">alarm id</td>
</tr>
<tr class="odd">
<td align="left">project_id</td>
<td align="left">string</td>
<td align="left">admin可指定</td>
<td align="left">NO</td>
<td align="left">alarm所属项目</td>
</tr>
<tr class="even">
<td align="left">user_id</td>
<td align="left">string</td>
<td align="left">admin可指定</td>
<td align="left">NO</td>
<td align="left">alarm所属用户</td>
</tr>
<tr class="odd">
<td align="left">description</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">NO</td>
<td align="left">描述</td>
</tr>
<tr class="even">
<td align="left">state</td>
<td align="left">string</td>
<td align="left">见state可选值表</td>
<td align="left">NO</td>
<td align="left">状态</td>
</tr>
<tr class="odd">
<td align="left">enabled</td>
<td align="left">bool</td>
<td align="left">见enabled约束表</td>
<td align="left">NO</td>
<td align="left">是否启用</td>
</tr>
<tr class="even">
<td align="left">alarm_action</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">NO</td>
<td align="left">报警时的动作</td>
</tr>
<tr class="odd">
<td align="left">ok_action</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">NO</td>
<td align="left">正常时的动作</td>
</tr>
<tr class="even">
<td align="left">insufficient_data_action</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">NO</td>
<td align="left">数据不正常时的动作</td>
</tr>
<tr class="odd">
<td align="left">repeat_actions</td>
<td align="left">bool</td>
<td align="left">N/A</td>
<td align="left">NO</td>
<td align="left">是否重复执行动作，为真则每次进入状态均执行</td>
</tr>
</tbody>
</table>
<p>type可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">threshold</td>
<td align="left">阈值</td>
</tr>
<tr class="even">
<td align="left">combination</td>
<td align="left">组合</td>
</tr>
</tbody>
</table>
<p>threshold_rule结构体</p>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">meter_name</td>
<td align="left">string</td>
<td align="left">N/A</td>
<td align="left">YES</td>
<td align="left">度量名称</td>
</tr>
<tr class="even">
<td align="left">threshold</td>
<td align="left">float</td>
<td align="left">N/A</td>
<td align="left">YES</td>
<td align="left">阈值</td>
</tr>
<tr class="odd">
<td align="left">period</td>
<td align="left">int</td>
<td align="left">N/A</td>
<td align="left">NO</td>
<td align="left">周期</td>
</tr>
<tr class="even">
<td align="left">evaluation_periods</td>
<td align="left">int</td>
<td align="left">N/A</td>
<td align="left">NO</td>
<td align="left">计算周期数</td>
</tr>
<tr class="odd">
<td align="left">statistic</td>
<td align="left">string</td>
<td align="left">见statistic可选值表</td>
<td align="left">NO</td>
<td align="left">统计选项</td>
</tr>
<tr class="even">
<td align="left">comparison_operator</td>
<td align="left">string</td>
<td align="left">见comparison_operator可选值表</td>
<td align="left">NO</td>
<td align="left">比较符</td>
</tr>
<tr class="odd">
<td align="left">query</td>
<td align="left">string</td>
<td align="left">json list</td>
<td align="left">NO</td>
<td align="left">统计时的过滤项</td>
</tr>
</tbody>
</table>
<p>combination_rule结构体</p>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alarm_ids</td>
<td align="left">string</td>
<td align="left">json list</td>
<td align="left">YES</td>
<td align="left">alarm id list</td>
</tr>
<tr class="even">
<td align="left">operator</td>
<td align="left">string</td>
<td align="left">YES</td>
<td align="left">NO</td>
<td align="left">逻辑操作符</td>
</tr>
</tbody>
</table>
<p>alarm_ids结构体</p>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N/A</td>
<td align="left">uuid</td>
<td align="left">必须存在</td>
<td align="left">YES</td>
<td align="left">alarm id</td>
</tr>
</tbody>
</table>
<p>state可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ok</td>
<td align="left">正常</td>
</tr>
<tr class="even">
<td align="left">alarm</td>
<td align="left">警报</td>
</tr>
<tr class="odd">
<td align="left">insufficient data</td>
<td align="left">数据不正确</td>
</tr>
</tbody>
</table>
<p>enabled约束表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">t, true, on, y, yes, 1</td>
<td align="left">大小写不敏感，取值为True</td>
</tr>
<tr class="even">
<td align="left">其他</td>
<td align="left">取值为False</td>
</tr>
</tbody>
</table>
<p>statistic可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">max</td>
<td align="left">最大值</td>
</tr>
<tr class="even">
<td align="left">min</td>
<td align="left">最小值</td>
</tr>
<tr class="odd">
<td align="left">avg</td>
<td align="left">平均值</td>
</tr>
<tr class="even">
<td align="left">sum</td>
<td align="left">总值</td>
</tr>
<tr class="odd">
<td align="left">count</td>
<td align="left">Sample的数量</td>
</tr>
</tbody>
</table>
<p>comparison_operator可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lt</td>
<td align="left">小于</td>
</tr>
<tr class="even">
<td align="left">le</td>
<td align="left">小于等于</td>
</tr>
<tr class="odd">
<td align="left">eq</td>
<td align="left">等于</td>
</tr>
<tr class="even">
<td align="left">ne</td>
<td align="left">不等于</td>
</tr>
<tr class="odd">
<td align="left">ge</td>
<td align="left">大于等于</td>
</tr>
<tr class="even">
<td align="left">gt</td>
<td align="left">大于</td>
</tr>
</tbody>
</table>
<p>operator可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">and</td>
<td align="left">逻辑与，条件同时满足判定为真</td>
</tr>
<tr class="even">
<td align="left">or</td>
<td align="left">逻辑或，条件之一满足判定为真</td>
</tr>
</tbody>
</table>
<ul>
<li>response body参数</li>
</ul>
<p>待更新</p>
<ul>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">POST /v2/alarms</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">{
    <span class="dt">&quot;name&quot;</span>: <span class="st">&quot;alarm-test&quot;</span>,
    <span class="dt">&quot;repeat_actions&quot;</span>: <span class="dv">false</span>,
    <span class="dt">&quot;threshold_rule&quot;</span>: {
        <span class="dt">&quot;meter_name&quot;</span>: <span class="st">&quot;instance&quot;</span>,
        <span class="dt">&quot;threshold&quot;</span>: <span class="fl">10.0</span>
    },
    <span class="dt">&quot;type&quot;</span>: <span class="st">&quot;threshold&quot;</span>
}</code></pre></td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">{
    <span class="dt">&quot;alarm_actions&quot;</span>: [],
    <span class="dt">&quot;alarm_id&quot;</span>: <span class="st">&quot;048341c1-5f41-4d8b-8b1e-a3816a5d9859&quot;</span>,
    <span class="dt">&quot;description&quot;</span>: <span class="st">&quot;Alarm when instance is eq a avg of 10.0 over 60 seconds&quot;</span>,
    <span class="dt">&quot;enabled&quot;</span>: <span class="dv">true</span>,
    <span class="dt">&quot;insufficient_data_actions&quot;</span>: [],
    <span class="dt">&quot;name&quot;</span>: <span class="st">&quot;alarm-test&quot;</span>,
    <span class="dt">&quot;ok_actions&quot;</span>: [],
    <span class="dt">&quot;project_id&quot;</span>: <span class="st">&quot;313a8bc21b994e60b93d6fff7c1e0c1b&quot;</span>,
    <span class="dt">&quot;repeat_actions&quot;</span>: <span class="dv">false</span>,
    <span class="dt">&quot;state&quot;</span>: <span class="st">&quot;insufficient data&quot;</span>,
    <span class="dt">&quot;state_timestamp&quot;</span>: <span class="st">&quot;2014-02-11T04:20:02.193000&quot;</span>,
    <span class="dt">&quot;threshold_rule&quot;</span>: {
        <span class="dt">&quot;comparison_operator&quot;</span>: <span class="st">&quot;eq&quot;</span>,
        <span class="dt">&quot;evaluation_periods&quot;</span>: <span class="dv">1</span>,
        <span class="dt">&quot;meter_name&quot;</span>: <span class="st">&quot;instance&quot;</span>,
        <span class="dt">&quot;period&quot;</span>: <span class="dv">60</span>,
        <span class="dt">&quot;query&quot;</span>: [],
        <span class="dt">&quot;statistic&quot;</span>: <span class="st">&quot;avg&quot;</span>,
        <span class="dt">&quot;threshold&quot;</span>: <span class="fl">10.0</span>
    },
    <span class="dt">&quot;timestamp&quot;</span>: <span class="st">&quot;2014-02-11T04:20:02.193000&quot;</span>,
    <span class="dt">&quot;type&quot;</span>: <span class="st">&quot;threshold&quot;</span>,
    <span class="dt">&quot;user_id&quot;</span>: <span class="st">&quot;30aee73695744a6096e35fdab25b6766&quot;</span>
}</code></pre></td>
</tr>
</tbody>
</table>
<p>注意，创建同名的alarm将返回：</p>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 400</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">{
    <span class="dt">&quot;error_message&quot;</span>: {
        <span class="dt">&quot;debuginfo&quot;</span>: <span class="dv">null</span>,
        <span class="dt">&quot;faultcode&quot;</span>: <span class="st">&quot;Client&quot;</span>,
        <span class="dt">&quot;faultstring&quot;</span>: <span class="st">&quot;Alarm with that name exists&quot;</span>
    }
}</code></pre></td>
</tr>
</tbody>
</table>
<h3 id="查询告警详情show-alarm"><span class="header-section-number">5.5.3</span> 查询告警详情（Show Alarm）</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GET</td>
<td align="left">/v2/alarms/{alarm_id}</td>
<td align="left">获取指定alarm详细信息</td>
</tr>
</tbody>
</table>
<ul>
<li>request filter参数</li>
</ul>
<p>无</p>
<ul>
<li>request body参数</li>
</ul>
<p>无</p>
<ul>
<li>response body参数</li>
</ul>
<p>待更新</p>
<ul>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/alarms/7505cd03-dc0f-4539-9906-d019783148fe</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">{
    <span class="dt">&quot;alarm_actions&quot;</span>: [],
    <span class="dt">&quot;alarm_id&quot;</span>: <span class="st">&quot;7505cd03-dc0f-4539-9906-d019783148fe&quot;</span>,
    <span class="dt">&quot;description&quot;</span>: <span class="st">&quot;Alarm when instance is eq a avg of 5.0 over 60 seconds&quot;</span>,
    <span class="dt">&quot;enabled&quot;</span>: <span class="dv">true</span>,
    <span class="dt">&quot;insufficient_data_actions&quot;</span>: [],
    <span class="dt">&quot;name&quot;</span>: <span class="st">&quot;test-member-create-alarm&quot;</span>,
    <span class="dt">&quot;ok_actions&quot;</span>: [],
    <span class="dt">&quot;project_id&quot;</span>: <span class="st">&quot;aebb7f33b7fc4cf486d3a2cdacac8ac1&quot;</span>,
    <span class="dt">&quot;repeat_actions&quot;</span>: <span class="dv">false</span>,
    <span class="dt">&quot;state&quot;</span>: <span class="st">&quot;insufficient data&quot;</span>,
    <span class="dt">&quot;state_timestamp&quot;</span>: <span class="st">&quot;2014-02-08T10:07:03.870000&quot;</span>,
    <span class="dt">&quot;threshold_rule&quot;</span>: {
        <span class="dt">&quot;comparison_operator&quot;</span>: <span class="st">&quot;eq&quot;</span>,
        <span class="dt">&quot;evaluation_periods&quot;</span>: <span class="dv">1</span>,
        <span class="dt">&quot;meter_name&quot;</span>: <span class="st">&quot;instance&quot;</span>,
        <span class="dt">&quot;period&quot;</span>: <span class="dv">60</span>,
        <span class="dt">&quot;query&quot;</span>: [
            {
                <span class="dt">&quot;field&quot;</span>: <span class="st">&quot;project_id&quot;</span>,
                <span class="dt">&quot;op&quot;</span>: <span class="st">&quot;eq&quot;</span>,
                <span class="dt">&quot;value&quot;</span>: <span class="st">&quot;aebb7f33b7fc4cf486d3a2cdacac8ac1&quot;</span>
            }
        ],
        <span class="dt">&quot;statistic&quot;</span>: <span class="st">&quot;avg&quot;</span>,
        <span class="dt">&quot;threshold&quot;</span>: <span class="fl">5.0</span>
    },
    <span class="dt">&quot;timestamp&quot;</span>: <span class="st">&quot;2014-02-08T10:07:03.870000&quot;</span>,
    <span class="dt">&quot;type&quot;</span>: <span class="st">&quot;threshold&quot;</span>,
    <span class="dt">&quot;user_id&quot;</span>: <span class="st">&quot;f86eeee169ed48cf892ceac3d5e27a9f&quot;</span>
}</code></pre></td>
</tr>
</tbody>
</table>
<h3 id="更新告警update-alarm"><span class="header-section-number">5.5.4</span> 更新告警（Update Alarm）</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PUT</td>
<td align="left">/v2/alarms/{alarm_id}</td>
<td align="left">修改指定alarm信息</td>
</tr>
</tbody>
</table>
<ul>
<li>request filter参数</li>
</ul>
<p>无</p>
<ul>
<li>request body参数</li>
</ul>
<p>见创建告警章节</p>
<ul>
<li>response body参数</li>
</ul>
<p>见创建告警章节</p>
<ul>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">PUT /v2/alarms/7505cd03-dc0f-4539-9906-d019783148fe</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">{
    <span class="dt">&quot;name&quot;</span>: <span class="st">&quot;test-member-create-alarm&quot;</span>,
    <span class="dt">&quot;threshold_rule&quot;</span>: {
        <span class="dt">&quot;meter_name&quot;</span>: <span class="st">&quot;instance&quot;</span>,
        <span class="dt">&quot;threshold&quot;</span>: <span class="fl">10.0</span>
    },
    <span class="dt">&quot;type&quot;</span>: <span class="st">&quot;threshold&quot;</span>
}</code></pre></td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">{
    <span class="dt">&quot;alarm_actions&quot;</span>: [],
    <span class="dt">&quot;alarm_id&quot;</span>: <span class="st">&quot;7505cd03-dc0f-4539-9906-d019783148fe&quot;</span>,
    <span class="dt">&quot;description&quot;</span>: <span class="st">&quot;Alarm when instance is eq a avg of 10.0 over 60 seconds&quot;</span>,
    <span class="dt">&quot;enabled&quot;</span>: <span class="dv">true</span>,
    <span class="dt">&quot;insufficient_data_actions&quot;</span>: [],
    <span class="dt">&quot;name&quot;</span>: <span class="st">&quot;test-member-create-alarm&quot;</span>,
    <span class="dt">&quot;ok_actions&quot;</span>: [],
    <span class="dt">&quot;project_id&quot;</span>: <span class="st">&quot;aebb7f33b7fc4cf486d3a2cdacac8ac1&quot;</span>,
    <span class="dt">&quot;repeat_actions&quot;</span>: <span class="dv">false</span>,
    <span class="dt">&quot;state&quot;</span>: <span class="st">&quot;insufficient data&quot;</span>,
    <span class="dt">&quot;state_timestamp&quot;</span>: <span class="st">&quot;2014-02-15T08:02:22.189000&quot;</span>,
    <span class="dt">&quot;threshold_rule&quot;</span>: {
        <span class="dt">&quot;comparison_operator&quot;</span>: <span class="st">&quot;eq&quot;</span>,
        <span class="dt">&quot;evaluation_periods&quot;</span>: <span class="dv">1</span>,
        <span class="dt">&quot;meter_name&quot;</span>: <span class="st">&quot;instance&quot;</span>,
        <span class="dt">&quot;period&quot;</span>: <span class="dv">60</span>,
        <span class="dt">&quot;query&quot;</span>: [
            {
                <span class="dt">&quot;field&quot;</span>: <span class="st">&quot;project_id&quot;</span>,
                <span class="dt">&quot;op&quot;</span>: <span class="st">&quot;eq&quot;</span>,
                <span class="dt">&quot;value&quot;</span>: <span class="st">&quot;aebb7f33b7fc4cf486d3a2cdacac8ac1&quot;</span>
            }
        ],
        <span class="dt">&quot;statistic&quot;</span>: <span class="st">&quot;avg&quot;</span>,
        <span class="dt">&quot;threshold&quot;</span>: <span class="fl">10.0</span>
    },
    <span class="dt">&quot;timestamp&quot;</span>: <span class="st">&quot;2014-02-15T16:41:03.528000&quot;</span>,
    <span class="dt">&quot;type&quot;</span>: <span class="st">&quot;threshold&quot;</span>,
    <span class="dt">&quot;user_id&quot;</span>: <span class="st">&quot;f86eeee169ed48cf892ceac3d5e27a9f&quot;</span>
}</code></pre></td>
</tr>
</tbody>
</table>
<h3 id="删除告警delete-alarm"><span class="header-section-number">5.5.5</span> 删除告警（Delete Alarm）</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">DELETE</td>
<td align="left">/v2/alarms/{alarm_id}</td>
<td align="left">删除指定alarm</td>
</tr>
</tbody>
</table>
<ul>
<li>request filter参数</li>
</ul>
<p>无</p>
<ul>
<li>response body参数</li>
</ul>
<p>无</p>
<ul>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">DELETE /v2/alarms/c4278318-0572-45b6-96f8-e321cf44f817</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 204</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<h3 id="查询告警状态get-alarm-state"><span class="header-section-number">5.5.6</span> 查询告警状态（Get Alarm State）</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GET</td>
<td align="left">/v2/alarms/{alarm_id}/state</td>
<td align="left">获取指定alarm状态</td>
</tr>
</tbody>
</table>
<ul>
<li>request filter参数</li>
</ul>
<p>无</p>
<ul>
<li>request body参数</li>
</ul>
<p>无</p>
<ul>
<li>response body参数</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N/A</td>
<td align="left">string</td>
<td align="left">见state可选值表</td>
<td align="left">YES</td>
<td align="left">告警状态</td>
</tr>
</tbody>
</table>
<p>state可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ok</td>
<td align="left">正常</td>
</tr>
<tr class="even">
<td align="left">alarm</td>
<td align="left">警报</td>
</tr>
<tr class="odd">
<td align="left">insufficient data</td>
<td align="left">数据不正确</td>
</tr>
</tbody>
</table>
<ul>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/alarms/7505cd03-dc0f-4539-9906-d019783148fe/state</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json"><span class="er">&quot;insufficient</span> <span class="er">data&quot;</span></code></pre></td>
</tr>
</tbody>
</table>
<h3 id="更新告警状态set-alarm-state"><span class="header-section-number">5.5.7</span> 更新告警状态(Set Alarm State)</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PUT</td>
<td align="left">/v2/alarms/{alarm_id}/state</td>
<td align="left">更新指定alarm状态</td>
</tr>
</tbody>
</table>
<ul>
<li>request filter参数</li>
</ul>
<p>无</p>
<ul>
<li>request body参数</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N/A</td>
<td align="left">string</td>
<td align="left">见state可选值表</td>
<td align="left">YES</td>
<td align="left">告警状态</td>
</tr>
</tbody>
</table>
<p>state可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ok</td>
<td align="left">正常</td>
</tr>
<tr class="even">
<td align="left">alarm</td>
<td align="left">警报</td>
</tr>
<tr class="odd">
<td align="left">insufficient data</td>
<td align="left">数据不正确</td>
</tr>
</tbody>
</table>
<p>大小写敏感，提交错误的状态将会返回400 Bad Request</p>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 400</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">{
    <span class="dt">&quot;error_message&quot;</span>: {
        <span class="dt">&quot;debuginfo&quot;</span>: <span class="dv">null</span>,
        <span class="dt">&quot;faultcode&quot;</span>: <span class="st">&quot;Client&quot;</span>,
        <span class="dt">&quot;faultstring&quot;</span>: <span class="st">&quot;state invalid&quot;</span>
    }
}</code></pre></td>
</tr>
</tbody>
</table>
<ul>
<li>response body参数</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">参数名</th>
<th align="left">参数类型</th>
<th align="left">约束</th>
<th align="left">必选</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N/A</td>
<td align="left">string</td>
<td align="left">见state可选值表</td>
<td align="left">YES</td>
<td align="left">告警状态</td>
</tr>
</tbody>
</table>
<p>state可选值表</p>
<table>
<thead>
<tr class="header">
<th align="left">可选值</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ok</td>
<td align="left">正常</td>
</tr>
<tr class="even">
<td align="left">alarm</td>
<td align="left">警报</td>
</tr>
<tr class="odd">
<td align="left">insufficient data</td>
<td align="left">数据不正确</td>
</tr>
</tbody>
</table>
<ul>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">PUT /v2/alarms/7505cd03-dc0f-4539-9906-d019783148fe/state</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json"><span class="er">&quot;ok&quot;</span></code></pre></td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json"><span class="er">&quot;ok&quot;</span></code></pre></td>
</tr>
</tbody>
</table>
<h3 id="查询告警历史信息show-alarm-history"><span class="header-section-number">5.5.8</span> 查询告警历史信息(Show Alarm History)</h3>
<table>
<thead>
<tr class="header">
<th align="left">REST VERB</th>
<th align="left">URI</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PUT</td>
<td align="left">/v2/alarms/{alarm_id}/history</td>
<td align="left">获取指定alarm历史信息</td>
</tr>
</tbody>
</table>
<p>history是alarm的变动记录，对应模型AlarmChange，对应数据库表alarm_history。</p>
<ul>
<li>request filter参数</li>
</ul>
<p>未知，从代码角度能看到支持过滤选项，但是经过试验又总是提示state invalid，即使过滤条件是state也如此。</p>
<ul>
<li>request body参数</li>
</ul>
<p>无</p>
<ul>
<li>response body参数</li>
</ul>
<p>待更新</p>
<ul>
<li><p>相关配置</p></li>
<li><p>JSON请求样例</p></li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">GET /v2/alarms/7505cd03-dc0f-4539-9906-d019783148fe/history</td>
</tr>
<tr class="even">
<td align="left">N/A</td>
</tr>
</tbody>
</table>
<ul>
<li>JSON响应样例</li>
</ul>
<table>
<col width="2%" />
<tbody>
<tr class="odd">
<td align="left">STATUS CODE 200</td>
</tr>
<tr class="even">
<td align="left"><pre class="sourceCode json"><code class="sourceCode json">[
    {
        <span class="dt">&quot;alarm_id&quot;</span>: <span class="st">&quot;7505cd03-dc0f-4539-9906-d019783148fe&quot;</span>,
        <span class="dt">&quot;detail&quot;</span>: {
            <span class="dt">&quot;alarm_actions&quot;</span>: [],
            <span class="dt">&quot;alarm_id&quot;</span>: <span class="st">&quot;7505cd03-dc0f-4539-9906-d019783148fe&quot;</span>,
            <span class="dt">&quot;description&quot;</span>: <span class="st">&quot;Alarm when instance is eq a avg of 5.0 over 60 seconds&quot;</span>,
            <span class="dt">&quot;enabled&quot;</span>: <span class="dv">true</span>,
            <span class="dt">&quot;insufficient_data_actions&quot;</span>: [],
            <span class="dt">&quot;name&quot;</span>: <span class="st">&quot;test-member-create-alarm&quot;</span>,
            <span class="dt">&quot;ok_actions&quot;</span>: [],
            <span class="dt">&quot;project_id&quot;</span>: <span class="st">&quot;aebb7f33b7fc4cf486d3a2cdacac8ac1&quot;</span>,
            <span class="dt">&quot;repeat_actions&quot;</span>: <span class="dv">false</span>,
            <span class="dt">&quot;rule&quot;</span>: {
                <span class="dt">&quot;comparison_operator&quot;</span>: <span class="st">&quot;eq&quot;</span>,
                <span class="dt">&quot;evaluation_periods&quot;</span>: <span class="dv">1</span>,
                <span class="dt">&quot;meter_name&quot;</span>: <span class="st">&quot;instance&quot;</span>,
                <span class="dt">&quot;period&quot;</span>: <span class="dv">60</span>,
                <span class="dt">&quot;query&quot;</span>: [
                    {
                        <span class="dt">&quot;field&quot;</span>: <span class="st">&quot;project_id&quot;</span>,
                        <span class="dt">&quot;op&quot;</span>: <span class="st">&quot;eq&quot;</span>,
                        <span class="dt">&quot;value&quot;</span>: <span class="st">&quot;aebb7f33b7fc4cf486d3a2cdacac8ac1&quot;</span>
                    }
                ],
                <span class="dt">&quot;statistic&quot;</span>: <span class="st">&quot;avg&quot;</span>,
                <span class="dt">&quot;threshold&quot;</span>: <span class="fl">5.0</span>
            },
            <span class="dt">&quot;state&quot;</span>: <span class="st">&quot;insufficient data&quot;</span>,
            <span class="dt">&quot;state_timestamp&quot;</span>: <span class="st">&quot;2014-02-08T10:07:03.870024&quot;</span>,
            <span class="dt">&quot;timestamp&quot;</span>: <span class="st">&quot;2014-02-08T10:07:03.870024&quot;</span>,
            <span class="dt">&quot;type&quot;</span>: <span class="st">&quot;threshold&quot;</span>,
            <span class="dt">&quot;user_id&quot;</span>: <span class="st">&quot;f86eeee169ed48cf892ceac3d5e27a9f&quot;</span>
        },
        <span class="dt">&quot;event_id&quot;</span>: <span class="st">&quot;758e4f1d-cf0a-4b19-b715-856528be7aba&quot;</span>,
        <span class="dt">&quot;on_behalf_of&quot;</span>: <span class="st">&quot;aebb7f33b7fc4cf486d3a2cdacac8ac1&quot;</span>,
        <span class="dt">&quot;project_id&quot;</span>: <span class="st">&quot;aebb7f33b7fc4cf486d3a2cdacac8ac1&quot;</span>,
        <span class="dt">&quot;timestamp&quot;</span>: <span class="st">&quot;2014-02-08T10:07:03.870000&quot;</span>,
        <span class="dt">&quot;type&quot;</span>: <span class="st">&quot;creation&quot;</span>,
        <span class="dt">&quot;user_id&quot;</span>: <span class="st">&quot;f86eeee169ed48cf892ceac3d5e27a9f&quot;</span>
    }
]</code></pre></td>
</tr>
</tbody>
</table>
<p>detail的实际返回是：&quot;{&quot;alarm_actions&quot;: [], &quot;user_id&quot;: &quot;f86eeee169ed48cf892ceac3d5e27a9f&quot;, &quot;name&quot;: &quot;test-member-create-alarm&quot;, &quot;timestamp&quot;: &quot;2014-02-08T10:07:03.870024&quot;, &quot;enabled&quot;: true, &quot;state_timestamp&quot;: &quot;2014-02-08T10:07:03.870024&quot;, &quot;rule&quot;: {&quot;meter_name&quot;: &quot;instance&quot;, &quot;evaluation_periods&quot;: 1, &quot;period&quot;: 60, &quot;statistic&quot;: &quot;avg&quot;, &quot;threshold&quot;: 5.0, &quot;query&quot;: [{&quot;field&quot;: &quot;project_id&quot;, &quot;value&quot;: &quot;aebb7f33b7fc4cf486d3a2cdacac8ac1&quot;, &quot;op&quot;: &quot;eq&quot;}], &quot;comparison_operator&quot;: &quot;eq&quot;}, &quot;alarm_id&quot;: &quot;7505cd03-dc0f-4539-9906-d019783148fe&quot;, &quot;state&quot;: &quot;insufficient data&quot;, &quot;insufficient_data_actions&quot;: [], &quot;repeat_actions&quot;: false, &quot;ok_actions&quot;: [], &quot;project_id&quot;: &quot;aebb7f33b7fc4cf486d3a2cdacac8ac1&quot;, &quot;type&quot;: &quot;threshold&quot;, &quot;description&quot;: &quot;Alarm when instance is eq a avg of 5.0 over 60 seconds&quot;}&quot;。考虑到这可能是一个bug，且对排版不利，示例中对这段string做了json转换。</p>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45606410-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'zqfan'; // required: replace example with your forum shortname
    /* var disqus_title = '$title$'; */
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<p><a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a></p>
</body>
</html>
